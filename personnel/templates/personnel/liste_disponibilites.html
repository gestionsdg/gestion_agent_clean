{% extends 'base.html' %}
{% block title %}{{ titre }}{% endblock %}

{% block content %}
<!-- TITRE CENTR√â ET SOULIGN√â -->
<h2 style="text-align: center; text-decoration: underline; font-weight: bold; margin-bottom: 20px;">
    {{ titre }}
</h2>

<!-- BOUTONS ACTIONS : RETOUR √Ä GAUCHE | IMPRIMER √Ä DROITE -->
<div class="actions" style="margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center;">
  <!-- Bouton retour -->
  <a href="{% url 'liste_employes' %}" class="btn btn-secondary" style="padding: 6px 12px; background-color: #ccc; text-decoration: none; border-radius: 5px;">
    ‚¨Ö Retour √† la liste des employ√©s
  </a>

  <!-- Bouton PDF -->
  <a href="{% url 'liste_disponibilite_pdf' %}" target="_blank">
    <button class="btn-imprimer" style="background-color: #87CEFA; color: black; border: none; padding: 8px 16px; border-radius: 5px; cursor: pointer;">
      üñ®Ô∏è Imprimer en PDF
    </button>
  </a>
</div>

<!-- TABLEAU DES AGENTS EN DISPONIBILIT√â -->
<table style="width: 100%; border-collapse: collapse; font-size: 14px;">
  <thead>
    <tr>
      {% for col in colonnes %}
        <th style="border: 1px solid #ccc; padding: 6px; text-align: center;">{{ col }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for item in donnees %}
    <tr>
      {% for val in item %}
        {% if forloop.counter == 1 or forloop.counter == 3 or forloop.counter == 5 or forloop.counter == 6 %}
          <td style="border: 1px solid #ccc; padding: 6px; text-align: center;">{{ val|default:"-" }}</td>
        {% elif forloop.counter == 2 or forloop.counter == 4 or forloop.counter == 7 %}
          <td style="border: 1px solid #ccc; padding: 6px; text-align: left;">{{ val|default:"-" }}</td>
        {% else %}
          <td style="border: 1px solid #ccc; padding: 6px;">{{ val|default:"-" }}</td>
        {% endif %}
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- √âl√©ment "running" pour afficher UNIQUEMENT en DERNI√àRE page (WeasyPrint) -->
<div class="print-stamp-last">Document imprim√© : le {% now "d/m/Y H:i" %}</div>

<!-- FORMAT IMPRESSION EN PAYSAGE + tampon derni√®re page -->
<style>
  /* Masquer le tampon √† l'√©cran */
  .print-stamp-last { display: none; }

  @media print {
    @page {
      size: landscape;
      margin: 20mm 15mm 20mm 15mm;
      /* Par d√©faut, rien en pied de page */
      @bottom-right { content: none; }
    }
    /* Afficher le tampon uniquement sur la DERNI√àRE page (WeasyPrint) */
    @page :last {
      @bottom-right { content: element(doc_stamp); }
    }

    .actions, .btn-imprimer { display: none !important; }
    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }

    /* √âl√©ment "running" utilis√© pour le pied de page WeasyPrint */
    .print-stamp-last {
      display: block;
      position: running(doc_stamp);
      height: 0; overflow: hidden;   /* ne prend pas de place dans le flux */
      font-size: 11px; color: #555; text-align: right;
    }
  }
</style>
{% endblock %}
