{% extends 'base.html' %}
{% block title %}{{ titre }}{% endblock %}

{% block content %}
<h2 style="text-align: center; font-size: 20px; margin-bottom: 10px; text-decoration: underline; font-weight: bold;">
  {{ titre }}
</h2>

<table class="tbl">
  <thead>
    <tr>
      <th>N°</th>
      <th>Nom</th>
      <th>Matricule</th>
      <th>Grade actuel</th>   {# ✅ Nouvelle colonne #}
      <th>Sexe</th>
      <th>Date naissance</th>
      <th>Date retraite</th>
      <th>Âge départ</th>
      <th>Date engagement</th>
      <th>Carrière</th>
      <th>Entité</th>
    </tr>
  </thead>
  <tbody>
    {% for idx, emp in agents %}
      <tr>
        <td>{{ idx }}</td>
        <td class="left">{{ emp.nom|default:"-" }}</td>
        <td>{{ emp.matricule|default:"-" }}</td>
        <td class="left">{{ emp.grade_actuel|default:"-" }}</td>  {# ✅ Ajout de la donnée #}
        <td>{{ emp.sexe|default:"-" }}</td>
        <td>{{ emp.date_naissance|date:"d/m/Y"|default:"-" }}</td>
        <td>{{ emp.date_statut|date:"d/m/Y"|default:"-" }}</td>
        <td>{{ emp.age_depart|default:"-" }}</td>
        <td>{{ emp.date_engagement|date:"d/m/Y"|default:"-" }}</td>
        <td>{{ emp.carriere|default:"-" }}</td>
        <td class="left">{{ emp.entite|default:"-" }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<!-- ✅ Footer réutilisable, uniquement à l’impression -->
{% include "personnel/_footer_impression.html" %}

<style>
  .tbl { 
    width: 100%; 
    border-collapse: collapse; 
    font-size: 12px; 
    margin-top: 8px; 
  }
  .tbl th, 
  .tbl td { 
    border: 1px solid #000; 
    padding: 6px; 
    text-align: center; 
  }
  .tbl th { 
    background: #f2f2f2; 
    text-align: center;  /* ✅ centrage des titres */
  }
  .tbl td.left { 
    text-align: left; 
  }

  /* ✅ Empêche les retours à la ligne dans la colonne “Carrière” (10e colonne) */
  .tbl th:nth-child(10),
  .tbl td:nth-child(10) {
    white-space: nowrap;
  }

  thead { display: table-header-group; }
  tbody tr { page-break-inside: avoid; }

  /* WeasyPrint / impression navigateur */
  @page { size: A4 landscape; margin: 1cm; }

  /* ✅ Par défaut, ne pas afficher le footer à l’écran */
  .footer-impression { display: none; }

  @media print {
    body { padding-bottom: 60px !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .footer-impression { display: block; } /* ✅ visible seulement à l’impression */
  }
</style>
{% endblock %}
